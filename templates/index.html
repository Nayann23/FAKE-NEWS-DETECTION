<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI-Powered News Verifier</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Italianno&display=swap" rel="stylesheet" />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">


  <style>
    /* --- Base --- */
    body {
      font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: #000; /* pure black */
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    ::selection { background: rgba(94,234,212,0.12); }

    .font-signature {
      font-family: 'Italianno', cursive;
      font-size: 1.9rem;
      font-weight: bold;
      letter-spacing: 1px;
      text-decoration: underline;
      text-underline-offset: 6px;
    }

    /* --- Glass card look (subtle) --- */
    .glass {
      background: rgba(255,255,255,0.02);
      border: 1px solid rgba(255,255,255,0.06);
      backdrop-filter: blur(6px);
      box-shadow: 0 8px 30px rgba(0,0,0,0.6);
    }

    .glass-strong {
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.08);
      backdrop-filter: blur(8px);
      box-shadow: 0 12px 40px rgba(0,0,0,0.7);
    }

    .hidden-field {
      opacity: 0;
      height: 0;
      overflow: hidden;
      transition: all 0.45s cubic-bezier(.2,.9,.3,1);
    }
    .visible-field {
      opacity: 1;
      height: auto;
      margin-bottom: 1rem;
      transition: all 0.45s cubic-bezier(.2,.9,.3,1);
    }

    /* small fade for results */
    .fade {
      opacity: 0;
      transition: opacity 360ms ease;
    }
    .fade.show {
      opacity: 1;
    }

    /* keep textarea looking premium */
    textarea:focus, input:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(94,234,212,0.06);
    }

    /* responsive breakpoint tweak for nice spacing */
    @media (min-width: 1024px) {
      .app-height { min-height: calc(100vh - 3rem); }
    }
  </style>
</head>

<body class="min-h-screen text-gray-100 antialiased">

  <div class="w-full max-w-6xl mx-auto pt-12 app-height">
    <header class="mb-4">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-2xl md:text-3xl font-extrabold text-[#5eead4]">AI-Powered News Verifier</h1>
          <p class="text-sm text-gray-400 mt-1">Verify Truth. Empower Minds</p>
        </div>
       
      </div>
    </header>

    <!-- Split layout: left = editor & verify, right = controls + result -->
    <main class="glass-strong rounded-2xl overflow-hidden shadow-xl">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-0">

        <!-- LEFT: Editor area -->
        <section class="p-4 lg:p-6 border-b lg:border-b-0 lg:border-r border-white/6">
          <div class="flex flex-col h-full">
            <label class="text-xs text-gray-300 uppercase tracking-wide mb-2">News Article</label>
            <!-- reduced rows so title/author + result fits without scrolling -->
            <textarea id="news-text" name="text" rows="8"
              placeholder="Paste or type the news article here..."
              class="w-full resize-y bg-transparent border border-white/8 rounded-lg p-3 text-gray-100 placeholder-gray-500 focus:border-[#5eead4] transition"></textarea>

            <!-- Title & Author (kept hidden until sample generation) -->
            <div id="meta-row" class="mt-3 flex flex-col gap-3">
              <div id="title-wrapper" class="hidden-field">
                <label class="block text-xs text-gray-300 uppercase mb-1">Title</label>
                <input id="news-title" type="text" placeholder="Auto-generated title..."
                  class="w-full bg-transparent border border-white/8 rounded-lg px-3 py-2 text-gray-100 placeholder-gray-500 focus:border-[#5eead4] transition" />
              </div>

              <div id="author-wrapper" class="hidden-field">
                <label class="block text-xs text-gray-300 uppercase mb-1">Author</label>
                <input id="news-author" type="text" placeholder="Auto-generated author..."
                  class="w-full bg-transparent border border-white/8 rounded-lg px-3 py-2 text-gray-100 placeholder-gray-500 focus:border-[#5eead4] transition" />
              </div>
            </div>

            <!-- Verify button anchored at bottom on large screens -->
            <div class="mt-4 lg:mt-auto">
              <button id="verify-btn" name="check-news" type="submit"
                class="w-full md:w-56 flex items-center justify-center gap-3 px-5 py-3 rounded-lg border border-blue-500/30 text-blue-300 hover:bg-blue-500/8 transition font-semibold">
                <i class="fa-solid fa-shield-check opacity-80"></i>
                Verify Authenticity
              </button>
            </div>
          </div>
        </section>

        <!-- RIGHT: Controls / samples + RESULT -->
        <aside class="p-4 lg:p-6 flex flex-col gap-4">
          <div class="flex items-start justify-between">
            <div class="text-sm text-gray-400">Samples & Tools</div>
          </div>

          <!-- RESULT moved here so user doesn't need to scroll -->
          <div id="result-wrapper" class="">
            <div id="result-empty" class="w-full rounded-lg p-3 text-center text-sm text-gray-400 border border-white/10 bg-white/5">
              News status will appear here after verification.
            </div>
          </div>

          <div class="flex flex-col gap-3">
            <button id="generate-sample" type="button"
              class="w-full text-left px-3 py-3 rounded-lg glass border border-white/8 hover:scale-[1.01] transition flex items-center justify-between">
              <div>
                <div class="font-semibold text-gray-100">Generate Sample News</div>
                <div class="text-xs text-gray-400 mt-1">Streaming typewriter preview</div>
              </div>
              <i class="fa-solid fa-bolt text-yellow-300"></i>
            </button>

            <button id="generate-sample-input" type="button"
              class="w-full text-left px-3 py-3 rounded-lg glass border border-white/8 hover:scale-[1.01] transition flex items-center justify-between">
              <div>
                <div class="font-semibold text-gray-100">Sample Inputs</div>
                <div class="text-xs text-gray-400 mt-1">Instant fill without animation</div>
              </div>
              <i class="fa-solid fa-list text-purple-300"></i>
            </button>

            <button id="clear-btn" type="button"
              class="w-full text-left px-3 py-3 rounded-lg glass border border-white/8 hover:scale-[1.01] transition flex items-center justify-between">
              <div>
                <div class="font-semibold text-gray-100">Clear Input</div>
                <div class="text-xs text-gray-400 mt-1">Reset everything quickly</div>
              </div>
              <i class="fa-solid fa-trash text-red-400"></i>
            </button>
          </div>

          <!-- removed shortcuts display (replaced by result) -->
        </aside>
      </div>
      <!-- bottom result area removed intentionally -->
    </main>
  </div>

  <!-- Footer -->
<footer class="w-full max-w-6xl mx-auto mt-10 pt-6 pb-6 border-t border-white/10 flex flex-col md:flex-row items-center justify-between px-6">
  <!-- Left: Text -->
  <div class="text-center md:text-left mb-4 md:mb-0">
    <p class="text-sm text-gray-400 tracking-wide">© 2025 Nayan. All rights reserved.</p>
    <p class="text-sm text-gray-400">
      Design, Code & Evaluated by
      <span class="font-signature text-[#5eead4]">Nayan Darokar</span>
    </p>
  </div>

  <!-- Right: Icons -->
  <div class="flex justify-center md:justify-end gap-6 text-xl">
    <a href="mailto:reachout.nayan@gmail.com" class="text-gray-400 hover:text-[#5eead4] transition duration-300">
      <i class="fa-solid fa-envelope"></i>
    </a>
    <a href="https://www.linkedin.com/in/nayan-darokar-468a85294/" target="_blank" class="text-gray-400 hover:text-[#5eead4] transition duration-300">
      <i class="fa-brands fa-linkedin"></i>
    </a>
 
  </div>
</footer>

  <script>
    // ---------- behaviour (keeps all existing logic, improved layout) ----------
    document.addEventListener('DOMContentLoaded', () => {
      const textarea = document.getElementById('news-text');
      const titleInput = document.getElementById('news-title');
      const authorInput = document.getElementById('news-author');
      const titleWrapper = document.getElementById('title-wrapper');
      const authorWrapper = document.getElementById('author-wrapper');
      const generateBtn = document.getElementById('generate-sample');
      const generateInputBtn = document.getElementById('generate-sample-input');
      const clearBtn = document.getElementById('clear-btn');
      const verifyBtn = document.getElementById('verify-btn');
      const resultWrapper = document.getElementById('result-wrapper');

      let shimmerInterval = null;
      let loaderInterval = null;
      let typingInterval = null;

      // store last verified article & result to prevent re-verification
      let lastVerifiedText = null;
      let lastVerifiedResult = null;

      function getRandomDelay(min = 900, max = 1700) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      function clearAllIntervals() {
        [shimmerInterval, loaderInterval, typingInterval].forEach(i => { if (i) clearInterval(i); });
        shimmerInterval = loaderInterval = typingInterval = null;
      }

      function showTemporaryStatus(text = "Verifying authenticity") {
        clearAllIntervals();
        resultWrapper.innerHTML = '';
        const el = document.createElement('div');
        el.className = 'w-full rounded-lg p-3 text-center text-sm text-[#5eead4] border border-[#5eead4]/20 bg-[#5eead4]/5 font-medium tracking-wide fade';
        el.textContent = text;
        resultWrapper.appendChild(el);
        // fade in
        requestAnimationFrame(()=> el.classList.add('show'));

        let dots = 0;
        loaderInterval = setInterval(() => {
          dots = (dots + 1) % 4;
          el.textContent = text + '.'.repeat(dots);
        }, 400);
        return el;
      }

      function showMessage(msg, tone = 'yellow') {
        const tones = {
          yellow: { text: 'text-yellow-300', bg: 'bg-yellow-400/5', border: 'border-yellow-400/20' },
          red: { text: 'text-red-300', bg: 'bg-red-600/10', border: 'border-red-500/20' },
          green: { text: 'text-green-300', bg: 'bg-green-600/10', border: 'border-green-500/20' }
        };
        const style = tones[tone] || tones.yellow;
        clearAllIntervals();
        resultWrapper.innerHTML = `<div class="w-full rounded-lg p-3 text-center text-xl font-bold uppercase ${style.text} border ${style.border} ${style.bg} fade">${msg}</div>`;
        // fade in
        const el = resultWrapper.firstElementChild;
        requestAnimationFrame(()=> el.classList.add('show'));
      }

      function revealMetaFields() {
        titleWrapper.classList.remove('hidden-field');
        authorWrapper.classList.remove('hidden-field');
        titleWrapper.classList.add('visible-field');
        authorWrapper.classList.add('visible-field');
      }

      // Heuristic to decide which part is title vs author:
      function parseMeta(parts) {
        const a = (parts[0] || '').trim();
        const b = (parts[1] || '').trim();
        const body = (parts[2] || '').trim() || (parts[1] || parts[0] || '').trim();

        const wordsA = a.split(/\s+/).filter(Boolean).length;
        const wordsB = b.split(/\s+/).filter(Boolean).length;

        if (wordsA > 0 && wordsA <= 6 && wordsB >= 8) {
          return { title: b || 'Sample News Title', author: a || 'Anonymous Author', body };
        }
        return { title: a || 'Sample News Title', author: b || 'Anonymous Author', body };
      }

      // update verify button state based on last verified text
      function updateVerifyState() {
        const current = textarea.value.trim();
        if (lastVerifiedText !== null && current === lastVerifiedText) {
          verifyBtn.disabled = true;
        } else {
          verifyBtn.disabled = false;
        }
      }

      // Generate Sample News (typewriter streaming)
      generateBtn.addEventListener('click', () => {
        generateBtn.disabled = true;
        fetch('/sample')
          .then(res => res.json())
          .then(data => {
            const parts = data?.text?.split('|||') || ['', '', ''];
            const meta = parseMeta(parts);
            revealMetaFields();
            titleInput.value = meta.title;
            authorInput.value = meta.author;

            // show shimmer in textarea
            clearAllIntervals();
            textarea.value = "Fetching news samples... ⏳";
            shimmerInterval = setInterval(() => {
              textarea.value = textarea.value.endsWith('⏳') ? "Fetching news samples..." : "Fetching news samples... ⏳";
            }, 150);

            const temp = showTemporaryStatus('Preparing sample');
            setTimeout(() => {
              clearAllIntervals();
              textarea.value = '';
              if (temp && temp.parentNode) temp.parentNode.removeChild(temp);

              const words = (meta.body || '').split(/\s+/).filter(Boolean);
              let idx = 0;
              const speedMs = 10;
              typingInterval = setInterval(() => {
                textarea.value += (idx ? ' ' : '') + (words[idx] || '');
                idx++;
                if (idx >= words.length) {
                  clearAllIntervals();
                  // after typing finishes, update verify state (if matches lastVerified)
                  updateVerifyState();
                }
              }, speedMs);
            }, getRandomDelay());
          })
          .catch(() => {
            clearAllIntervals();
            textarea.value = '';
            showMessage('Failed to fetch sample.', 'red');
          })
          .finally(() => setTimeout(() => generateBtn.disabled = false, 600));
      });

      // Sample Inputs (instant fill)
      generateInputBtn.addEventListener('click', () => {
        generateInputBtn.disabled = true;
        fetch('/sample')
          .then(res => res.json())
          .then(data => {
            const parts = data?.text?.split('|||') || ['', '', ''];
            const meta = parseMeta(parts);
            revealMetaFields();
            titleInput.value = meta.title;
            authorInput.value = meta.author;
            clearAllIntervals();
            textarea.value = meta.body || parts[2] || parts[1] || parts[0] || '';
            resultWrapper.innerHTML = '<div id="result-empty" class="w-full rounded-lg p-3 text-center text-sm text-gray-400 border border-white/10 bg-white/5">News status will appear here after verification.</div>';
            updateVerifyState();
          })
          .catch(() => {
            showMessage('Failed to fetch sample.', 'red');
          })
          .finally(() => setTimeout(() => generateInputBtn.disabled = false, 300));
      });

      // Clear input (safe: cancels intervals and hides metas)
      clearBtn.addEventListener('click', (e) => {
        e.preventDefault();
        clearAllIntervals();
        titleWrapper.classList.remove('visible-field'); titleWrapper.classList.add('hidden-field');
        authorWrapper.classList.remove('visible-field'); authorWrapper.classList.add('hidden-field');
        titleInput.value = '';
        authorInput.value = '';
        textarea.value = '';
        lastVerifiedText = null;
        lastVerifiedResult = null;
        verifyBtn.disabled = false;
        resultWrapper.innerHTML = '<div id="result-empty" class="w-full rounded-lg p-3 text-center text-sm text-gray-400 border border-white/10 bg-white/5">News status will appear here after verification.</div>';
      });

      // Verify button: inline message if empty, else show loader and final "REAL" / "FAKE"
      verifyBtn.addEventListener('click', (e) => {
        e.preventDefault();
        clearAllIntervals();

        const currentText = textarea.value.trim();
        if (currentText === "") {
          showMessage("Please enter or generate a news article first.", 'yellow');
          return;
        }

        // if already verified same text, block (button should be disabled). extra safety:
        if (lastVerifiedText !== null && currentText === lastVerifiedText) {
          // show the previous result again (only REAL/FAKE)
          showMessage(lastVerifiedResult === 'REAL' ? 'REAL' : 'FAKE', lastVerifiedResult === 'REAL' ? 'green' : 'red');
          verifyBtn.disabled = true;
          return;
        }

        showTemporaryStatus('Verifying authenticity');

        // simulate verification delay — replace with your backend call if available
        setTimeout(() => {
          clearAllIntervals();
          const rand = Math.random();
          const result = rand > 0.5 ? 'REAL' : 'FAKE';
          showMessage(result, result === 'REAL' ? 'green' : 'red');

          // lock verification for this exact article text
          lastVerifiedText = currentText;
          lastVerifiedResult = result;
          verifyBtn.disabled = true;
        }, 1200);
      });

      // whenever user edits the textarea, allow re-verification only if text changed
      textarea.addEventListener('input', () => {
        updateVerifyState();
      });

      // Keyboard shortcuts
      document.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
          e.preventDefault(); verifyBtn.click();
        }
        if (e.shiftKey && e.key.toLowerCase() === 'g') {
          e.preventDefault(); generateBtn.click();
        }
      });

      // initial state check
      updateVerifyState();
    });
  </script>
</body>
</html>
